#Countries-->not sure if its needed to use
PortugalTemp <-GlobalCountryTemp %>% filter(Country == "Portugal") %>% select(Date, Country, LandAvgTemp)
GermanyTemp <-GlobalCountryTemp %>% filter(Country == "Germany")%>% select(Date, Country, LandAvgTemp)
UkTemp <-GlobalCountryTemp %>% filter(Country == "United Kingdom")%>% select(Date, Country, LandAvgTemp)
BrazilTemp <-GlobalCountryTemp %>% filter(Country == "Brazil")%>% select(Date, Country, LandAvgTemp)
USATemp <-GlobalCountryTemp %>% filter(Country == "United States")%>% select(Date, Country, LandAvgTemp)
ChinaTemp <-GlobalCountryTemp %>% filter(Country == "China")%>% select(Date, Country, LandAvgTemp)
MaliTemp <-GlobalCountryTemp %>% filter(Country == "Mali")%>% select(Date, Country, LandAvgTemp)
SouthAfricaTemp <-GlobalCountryTemp %>% filter(Country == "South Africa")%>% select(Date, Country, LandAvgTemp)
AustraliaTemp <-GlobalCountryTemp %>% filter(Country == "Australia")%>% select(Date, Country, LandAvgTemp)
GreenlandTemp <- GlobalCountryTemp %>% filter(Country == "Greenland")%>% select(Date, Country, LandAvgTemp)
GlobalTemp %>% autoplot(LandOceanAvgTemp)+
geom_line(color="blue")+
labs(title = "Land & Ocean Temperature - Global",
subtitle = "Average",
y="LandOceanAvgTemp Cº",
caption = "fig. 1")
GlobalCountryTemp %>% filter(Country == "Brazil") %>% autoplot(LandAvgTemp)+
geom_line(color="green")+
labs(title = "Land Temperature in Brazil - Since 1850",
subtitle="Average",
y="LandAvgTemp Cº",
caption = "fig. 2")
GlobalCountryTemp %>% filter(Country=="Global") %>% autoplot(LandAvgTempUnc)+
labs(title = "Land Average temperature Uncertainty - Evolution through time",
caption = "fig. 3")
GlobalTempV %>% ggplot()+
geom_line(data=GlobalTempV, aes(Date, LandMaxTemp, col="LandMaxTemp"))+
geom_line(data=GlobalTempV, aes(Date,LandAvgTemp,col="LandAvgTemp"),lwd=2)+
geom_line(data=GlobalTempV, aes(Date, LandMinTemp, col="LandMinTemp"))+
labs(title = "Land temperature - Global overview",
y="LandTemp Cº",
color="Temperature Type",
caption = "fig. 4")+
scale_color_manual(values= c("red","black","blue"))
GlobalCountryTemp %>% filter(Country %in% countries) %>% filter(year(Date)>1984) %>% autoplot(LandAvgTemp)+
geom_line(data=GlobalTempV ,aes(Date, LandAvgTemp, col= "Global"),lwd=2)+
labs(title= "Global & Country Land Temperature - Last 30 years",
subtitle = "Average",
y= "LandAvgTemp Cº",
caption = "fig. 5")+
ylim(-30,40)+
theme(legend.position = "right")
#seasonal and trending
GlobalCountryTemp %>%
filter(Country=="Global") %>%
gg_season(LandAvgTemp)+
labs(title = "Seasonality in global temperature - Land",
y="LandAvgTemp Cº",
color="Years",
caption = "fig. 6")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
gg_season(LandOceanAvgTemp)+
labs(title = "Seasonality in global temperature - Land and Ocean",
y="LandOceanAvgTemp Cº",
color="Years",
caption = "fig. 7")
#subseries
GlobalCountryTemp %>%
filter(Country=="Global") %>%
gg_subseries(LandAvgTemp)+
labs(title = "Subseries - monthly global analysis",
y="LandAvgTemp Cº",
caption = "fig. 8")
GlobalCountryTemp %>%
filter(Country %in% countries2) %>%
gg_subseries(LandAvgTemp)+
labs(title = "Subseries - monthly analysis",
y="LandAvgTemp Cº",
caption = "fig. 9")
GlobalCountryTemp %>%
filter(Country %in% countries3) %>%
gg_subseries(LandAvgTemp)+
labs(title = "Subseries - monthly analysis",
y="LandAvgTemp Cº",
caption = "fig. 10")
#6, 12 or 24 lags--> monthly data
#In this case 12 looks the best as it captures all months of one year
GlobalCountryTemp %>% filter(Country=="Global") %>% ACF(LandAvgTemp,lag_max = 12) %>% autoplot()+
labs(title = "Autocorrelation in LandAvgTemp - Global",
subtitle = "12 month lag",
caption = "fig. 11")
GlobalCountryTemp %>%
filter(Country %in% countries2)%>% ACF(LandAvgTemp,lag_max = 12) %>% autoplot()+
labs(title = "Autocorrelation in LandAvgTemp - Country",
subtitle = "12 month lag",
caption = "fig. 12")
#transforming it into yearly data since there is no seasonality
#showing the first 48 years
uncertainty<- GlobalCountryTemp %>% filter(Country=="Global") %>%
mutate(Year= year(Date)) %>%
as_tibble(GlobalCountryTemp) %>%
group_by(Year)%>%
select(-Date) %>%
summarise(LandAvgTempUnc= mean(LandAvgTempUnc))
uncertainty %>%as_tsibble(index=Year) %>% filter(Year> "1752") %>%
ACF(LandAvgTempUnc, lag_max = 48) %>% autoplot()+
labs(title = "Autocorrelation in LandAvgTempUnc - Global",
subtitle = "48 years lag",
caption = "fig. 13")
GlobalTemp %>%
filter(year(Date)>1838, year(Date)<1900) %>%
autoplot(LandAvgTemp)+
geom_line()+
labs(title = "Land Temperature - Global 1839-1899",
subtitle = "Average",
y="LandAvgTemp Cº",
caption = "fig. 14")
GlobalTemp %>%
filter(year(Date)>=1900, year(Date)<1990) %>%
autoplot(LandAvgTemp)+
geom_line()+
labs(title = "Land Temperature - Global 1900-1989",
subtitle = "Average",
y="LandAvgTemp Cº",
caption = "fig. 15")
GlobalTemp %>%
filter(year(Date)>=1990, year(Date)<2014) %>%
autoplot(LandAvgTemp)+
geom_line()+
labs(title = "Land Temperature - Global 1990-2013",
subtitle = "Average",
y="LandAvgTemp Cº",
caption = "fig. 16")
# Show components of land & ocean global average temperature
GlobalTemp %>%
select(LandOceanAvgTemp) -> land_ocean_global_temp
dec <- land_ocean_global_temp %>%
model(stl = STL(LandOceanAvgTemp))
components(dec)
# Show components of land global average temperature
GlobalTemp %>%
select(LandAvgTemp) -> land_global_temp
dec2 <- land_global_temp %>%
model(stl = STL(LandAvgTemp))
components(dec2)
land_ocean_global_temp %>%
autoplot(LandOceanAvgTemp, color = 'gray') +
autolayer(components(dec), trend, color = '#6666ff') +
ggtitle('Land and Ocean Global Temperature Trend')
land_global_temp %>%
autoplot(LandAvgTemp, color = 'gray') +
autolayer(components(dec2), trend, color = 'purple') +
ggtitle('Land Global Temperature Trend')
components(dec) %>%
autoplot() + ggtitle('Land and Ocean Global Temperature')
components(dec2) %>%
autoplot() + ggtitle('Land Global Temperature')
components(dec) %>% gg_subseries(season_year)
components(dec2) %>% gg_subseries(season_year)
europe <- c('Portugal', 'Germany', 'United Kingdom')
GlobalCountryTemp %>%
filter(Country %in% europe) %>%
select(Country, LandAvgTemp) %>%
index_by(Date) %>%
summarise(LandAvgTemp = mean(LandAvgTemp)) %>% na.omit() %>%
mutate(month= row_number()) %>%
select(LandAvgTemp, everything()) %>%
update_tsibble(index=month, regular = TRUE)-> land_temp_mean_europe
deceurope<- land_temp_mean_europe %>%
model(stl = STL(LandAvgTemp~ trend(window=7)+
season(window = "periodic"),
robust = TRUE))
components(deceurope) %>% autoplot()
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp),
Drift = RW(LandAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
autoplot((filter(GlobalCountryTemp, year(Date) > 2000))) +
labs(title = "Global Land Average Temperature - Forecast",
subtitle = "Drift and Seasonal naïve method",
y="LandAvgTemp Cº",
caption = "fig. 20")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandOceanAvgTemp),
Drift = RW(LandOceanAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land & Ocean Average Temperature - Forecast",
subtitle = "Drift and Seasonal naïve method",
y="LandOceanAvgTemp Cº",
caption = "fig. 21")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land Average Temperature - Forecast",
subtitle = "Drift method based on seasonal adjusted data",
y="LandAvgTemp Cº",
caption = "fig. 22")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
model(stlf = decomposition_model(
STL(LandOceanAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land & Ocean Average Temperature - Forecast",
subtitle = "Drift method based on seasonal adjusted data",
y="LandOceanAvgTemp Cº",
caption = "fig. 23")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
filter(!is.na(LandAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp),
Drift = RW(LandAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
filter(!is.na(LandAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
filter(!is.na(LandAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp),
Drift = RW(LandAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
model(stlf = decomposition_model(
STL(LandOceanAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land & Ocean Average Temperature - Forecast",
subtitle = "Drift method based on seasonal adjusted data",
y="LandOceanAvgTemp Cº",
caption = "fig. 23")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
model(stlf = decomposition_model(
STL(LandOceanAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land & Ocean Average Temperature - Forecast",
subtitle = "Drift method based on seasonal adjusted data",
y="LandOceanAvgTemp Cº",
caption = "fig. 23")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land Average Temperature - Forecast",
subtitle = "Drift method based on seasonal adjusted data",
y="LandAvgTemp Cº",
caption = "fig. 22")
View(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(Seasonal_naive = SNAIVE(LandOceanAvgTemp),
Drift = RW(LandOceanAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(stlf = decomposition_model(
STL(LandOceanAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(stlf = decomposition_model(
STL(LandOceanAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(stlf = decomposition_model(
STL(LandOceanAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid)
#%>% forecast(h = "8 years") %>%
#  autoplot((filter(GlobalCountryTemp, year(Date) > 2000))) +
#  labs(title = "Global Land Average Temperature - Forecast",
#       subtitle = "Drift and Seasonal naïve method",
#       y="LandAvgTemp Cº",
#       caption = "fig. 20")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + ggtitle("ACF of Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + ggtitle("ACF of Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + ggtitle("ACF of Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + ggtitle("ACF of Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + ggtitle("ACF of Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + ggtitle("ACF of Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
ACF(.resid) %>%
autoplot()
+ labs(title = "ACF of Residuals from Seasonal naïve method",
caption = "fig. 24")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + labs(title = "ACF of Residuals from Seasonal naïve method", caption = "fig. 24")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + labs(title = "Residuals from Seasonal naïve method", caption = "fig. 24")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + labs(title = "ACF of Residuals from Seasonal naïve method", caption = "fig. 25")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
augment() %>%
autoplot(.resid) + ylab("") + ggtitle("Residuals from Seasonal naïve method")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + ggtitle("ACF of Residuals from Seasonal naïve method")
