land_ocean_global_temp %>%
filter(year(Date)>1900) %>%
autoplot(LandOceanAvgTemp, color = 'gray') +
autolayer(comp_after1900, trend, color = '#6666ff') +
ggtitle('Land and Ocean Global Temperature Trend')+
labs(caption = "fig. 21")
land_global_temp %>%
autoplot(LandAvgTemp, color = 'gray') +
autolayer(components(dec2), season_adjust, color = 'purple') +
ggtitle('Seasonal Adjusted Land Global Temperature')+
labs(caption = "fig. 22")
components(dec) %>%
autoplot() + ggtitle('Land and Ocean Global Temperature STL Decomposition')+
labs(caption = "fig. 23")
#components(dec2) %>%
#  autoplot() + ggtitle('Land Global Temperature')
components(dec) %>%
autoplot(remainder, color = '#ff668c') + ggtitle('Land Global Temperature Remainder')+
labs(caption = "fig. 24")
#components(dec2) %>%
#autoplot(remainder, color = '#8c66ff') + ggtitle('Land and Ocean Global Temperature Remainder')
land_ocean_global_temp %>%
filter(year(Date) > 1990) %>%
model(seats = feasts::: SEATS(LandOceanAvgTemp)) %>%
components() -> seats_dec
autoplot(seats_dec) + labs(title = "Land and Ocean Global Temperature X-13 ARIMA-SEATS Decomposition", caption = "fig. 25")
#----------------------------------------------------------------
GlobalCountryTemp %>%
filter(year(Date)> 1850) %>%
filter (Country == 'Europe') %>%
select(LandAvgTemp) %>%
as_tibble() %>%
group_by(Date) %>%
summarise_at(vars(LandAvgTemp), list(LandTempEurope = mean)) %>%
as_tsibble() %>%
fill(LandTempEurope, .direction = 'down') -> tempEurope
decEurope <- tempEurope %>%
model(stl = STL(LandTempEurope))
#components(decEurope)
tempEurope %>%
autoplot(LandTempEurope, color = 'gray') +
autolayer(components(decEurope), trend, color = '#9900cc') +
ggtitle('Land Temperature Europe Trend') +
labs(caption = "fig. 26")
#----------------------------------------------------------------
GlobalCountryTemp %>%
filter(year(Date)> 1860) %>%
filter (Country == 'Africa') %>%
select(LandAvgTemp) %>%
as_tibble() %>%
group_by(Date) %>%
summarise_at(vars(LandAvgTemp), list(LandTempAfrica = mean)) %>%
as_tsibble() %>%
fill(LandTempAfrica, .direction = 'down') -> tempAfrica
decAfrica <- tempAfrica %>%
model(stl = STL(LandTempAfrica))
#components(decAfrica)
tempAfrica %>%
autoplot(LandTempAfrica, color = 'gray') +
autolayer(components(decAfrica), trend, color = '#e65c00') +
ggtitle('Land Temperature Africa Trend') +
labs(caption = "fig. 27")
#----------------------------------------------------------------
GlobalCountryTemp %>%
filter(year(Date)> 1850) %>%
filter (Country == 'Asia') %>%
select(LandAvgTemp) %>%
as_tibble() %>%
group_by(Date) %>%
summarise_at(vars(LandAvgTemp), list(LandTempAsia = mean)) %>%
as_tsibble() %>%
fill(LandTempAsia, .direction = 'down') -> tempAsia
decAsia <- tempAsia %>%
model(stl = STL(LandTempAsia))
#components(decAsia)
tempAsia %>%
autoplot(LandTempAsia, color = 'gray') +
autolayer(components(decAsia), trend, color = '#ff4d94') +
ggtitle('Land Temperature Asia Trend') +
labs(caption = "fig. 28")
#----------------------------------------------------------------
GlobalCountryTemp %>%
filter(year(Date)> 1850) %>%
filter (Country == 'South America') %>%
select(LandAvgTemp) %>%
as_tibble() %>%
group_by(Date) %>%
summarise_at(vars(LandAvgTemp), list(LandTempSouthAmerica = mean)) %>%
as_tsibble() %>%
fill(LandTempSouthAmerica, .direction = 'down') -> tempSouthAmerica
decSouthAmerica <- tempSouthAmerica %>%
model(stl = STL(LandTempSouthAmerica))
#components(decSouthAmerica)
tempSouthAmerica %>%
autoplot(LandTempSouthAmerica, color = 'gray') +
autolayer(components(decSouthAmerica), trend, color = '#008040') +
ggtitle('Land Temperature South America Trend') +
labs(caption = "fig. 29")
#----------------------------------------------------------------
GlobalCountryTemp %>%
filter(year(Date)> 1850) %>%
filter (Country == 'North America') %>%
select(LandAvgTemp) %>%
as_tibble() %>%
group_by(Date) %>%
summarise_at(vars(LandAvgTemp), list(LandTempNorthAmerica = mean)) %>%
as_tsibble() %>%
fill(LandTempNorthAmerica, .direction = 'down') -> tempNorthAmerica
decNorthAmerica <- tempNorthAmerica %>%
model(stl = STL(LandTempNorthAmerica))
#components(decNorthAmerica)
tempNorthAmerica %>%
autoplot(LandTempNorthAmerica, color = 'gray') +
autolayer(components(decNorthAmerica), trend, color = '#009999') +
ggtitle('Land Temperature North America Trend') +
labs(caption = "fig. 30")
#----------------------------------------------------------------
GlobalCountryTemp %>%
filter(year(Date)> 1850) %>%
filter (Country == 'Oceania') %>%
select(LandAvgTemp) %>%
as_tibble() %>%
group_by(Date) %>%
summarise_at(vars(LandAvgTemp), list(LandTempOceania = mean)) %>%
as_tsibble() %>%
fill(LandTempOceania, .direction = 'down') -> tempOceania
decOceania <- tempOceania %>%
model(stl = STL(LandTempOceania))
#components(decOceania)
tempOceania %>%
autoplot(LandTempOceania, color = 'gray') +
autolayer(components(decOceania), trend, color = '#99004d') +
ggtitle('Land Temperature Oceania Trend') +
labs(caption = "fig. 31")
GlobalCountryTemp %>%
fill(LandAvgTemp, .direction = "down") %>%
features(LandAvgTemp, feat_stl) %>%
drop_na(trend_strength, seasonal_strength_year) %>%
mutate(Continent = case_when(
Country %in% europe  ~ "Europe" ,
Country %in% africa  ~ "Africa" ,
Country %in% asia  ~ "Asia" ,
Country %in% north_america  ~ "North America",
Country %in% south_america  ~ "South America",
Country %in% oceania  ~ "Oceania"
)
) %>%
drop_na(Continent) %>%
ggplot(aes(x = trend_strength, y = seasonal_strength_year, colour = Continent)) +
scale_color_manual(values=c('#ff9900', '#ff4d94', '#9900cc', '#009999', '#ffcc00', '#00cc00')) +
geom_point() +
labs(title= 'Trend and Seasonal Strenght in different Countries', caption = "fig. 32")
components(dec) %>% gg_subseries(season_year) +
labs(title = 'Subseries by month of Land and Ocean Global Temperatures', caption = "fig. 33")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp),
Drift = RW(LandAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
autoplot((filter(GlobalCountryTemp, year(Date) > 2000))) +
labs(title = "Global Land Average Temperature - Forecast",
subtitle = "Drift and Seasonal naïve method",
y="LandAvgTemp Cº",
caption = "fig. 34")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandOceanAvgTemp),
Drift = RW(LandOceanAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land & Ocean Average Temperature - Forecast",
subtitle = "Drift and Seasonal naïve method",
y="LandOceanAvgTemp Cº",
caption = "fig. 35")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandAvgTemp, .direction = "down") %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land Average Temperature - Forecast",
subtitle = "Drift method based on seasonal adjusted data",
y="LandAvgTemp Cº",
caption = "fig. 36")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
model(stlf = decomposition_model(
STL(LandOceanAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>%
forecast(h = "8 years") %>%
autoplot(filter(GlobalCountryTemp, year(Date) > 2000)) +
labs(title = "Global Land & Ocean Average Temperature - Forecast",
subtitle = "Drift method based on seasonal adjusted data",
y="LandOceanAvgTemp Cº",
caption = "fig. 37")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
filter(!is.na(LandAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp),
Drift = RW(LandAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
filter(!is.na(LandAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(stlf = decomposition_model(
STL(LandAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(Seasonal_naive = SNAIVE(LandOceanAvgTemp),
Drift = RW(LandOceanAvgTemp ~ drift())
) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandOceanAvgTemp, .direction = "down") %>%
filter(!is.na(LandOceanAvgTemp)) %>%
stretch_tsibble(.init = 3, .step = 1) %>%
model(stlf = decomposition_model(
STL(LandOceanAvgTemp ~ trend(window = 7), robust = TRUE),
Drift = RW(season_adjust ~ drift())
)) %>% forecast(h = "8 years") %>%
accuracy(GlobalCountryTemp)
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
autoplot(.resid) + labs(title = "Residuals from Seasonal naïve method", caption = "fig. 24")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
fill(LandAvgTemp, .direction = "down") %>%
model(Seasonal_naive = SNAIVE(LandAvgTemp)) %>%
augment() %>%
ACF(.resid) %>%
autoplot() + labs(title = "ACF of Residuals from Seasonal naïve method", caption = "fig. 38")
GlobalCountryTemp %>%
filter(Country=="Global") %>%
filter(year(Date)>=1990) %>%
autoplot(LandAvgTemp)
GlobalCountryTemp %>%
filter(Country %in% c("Global", "North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990) %>%
autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
land_continents %>% autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
land_continents %>% autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
land_global <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
land_global %>% autoplot(LandAvgTemp)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
global_temp %>% autoplot(LandAvgTemp)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global <- global_temp %>% model(ets = ETS(LandAvgTemp))
report(fot_global)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global <- global_temp %>% model(ets = ETS(LandAvgTemp))
report(fit_global)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global <- global_temp %>% model(ets = ETS(LandAvgTemp))
report(fit_global)
accuracy(fit_global)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global <- global_temp %>%
model(
ANA = ETS(LandAvgTemp),
)
report(fit_global)
accuracy(fit_global)
tidy(fit_global)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global <- global_temp %>%
model(
ANA = ETS(LandAvgTemp),
)
report(fit_global)
accuracy(fit_global)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global <- global_temp %>%
model(
ANA = ETS(LandAvgTemp),
AAA = ETS(LandAvgTemp ~ error("A") + trend("A") + season("A")),
MAM = ETS(LandAvgTemp ~ error("M") + trend("A") + season("M"))
)
report(fit_global)
accuracy(fit_global)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global <- global_temp %>%
model(
ANA_Land = ETS(LandAvgTemp),
AAA_Land = ETS(LandAvgTemp ~ error("A") + trend("A") + season("A")),
MAM_Land = ETS(LandAvgTemp ~ error("M") + trend("A") + season("M")),
Land_Ocean = ETS(LandOceanAvgTemp)
)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global <- global_temp %>%
model(
ANA_Land = ETS(LandAvgTemp),
AAA_Land = ETS(LandAvgTemp ~ error("A") + trend("A") + season("A")),
MAM_Land = ETS(LandAvgTemp ~ error("M") + trend("A") + season("M"))
)
report(fit_global)
accuracy(fit_global)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global_land <- global_temp %>%
model(
ANA_Land = ETS(LandAvgTemp),
AAA_Land = ETS(LandAvgTemp ~ error("A") + trend("A") + season("A")),
MAM_Land = ETS(LandAvgTemp ~ error("M") + trend("A") + season("M"))
)
fit_global_ocean <- global_temp %>%
model(
LandOcean = ETS(LandOceanAvgTemp)
)
report(fit_global_land)
accuracy(fit_global_land)
report(fit_global_ocean)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global_land <- global_temp %>%
model(
ANA_Land = ETS(LandAvgTemp),
AAA_Land = ETS(LandAvgTemp ~ error("A") + trend("A") + season("A")),
MAM_Land = ETS(LandAvgTemp ~ error("M") + trend("A") + season("M"))
)
fit_global_ocean <- global_temp %>%
model(
LandOcean = ETS(LandOceanAvgTemp)
)
report(fit_global_land)
accuracy(fit_global_land)
report(fit_global_ocean)
global_temp %>% autoplot(LandAvgTemp)
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global_land <- global_temp %>%
model(
ANA_Land = ETS(LandAvgTemp),
AAA_Land = ETS(LandAvgTemp ~ error("A") + trend("A") + season("A")),
MAM_Land = ETS(LandAvgTemp ~ error("M") + trend("A") + season("M"))
)
fit_global_ocean <- global_temp %>%
model(
LandOcean = ETS(LandOceanAvgTemp)
)
report(fit_global_land)
accuracy(fit_global_land)
report(fit_global_ocean)
fit_global_land %>% components(AAA_Land) %>%  autoplot()
global_temp <-
GlobalCountryTemp %>%
filter(Country == "Global") %>%
filter(year(Date)>=1990)
fit_global_land <- global_temp %>%
model(
ANA_Land = ETS(LandAvgTemp),
AAA_Land = ETS(LandAvgTemp ~ error("A") + trend("A") + season("A")),
MAM_Land = ETS(LandAvgTemp ~ error("M") + trend("A") + season("M"))
)
report(fit_global_land)
accuracy(fit_global_land)
fit_global_land %>% components() %>%  autoplot()
fit_global_ocean <- global_temp %>%
model(
LandOcean = ETS(LandOceanAvgTemp)
)
report(fit_global_ocean)
land_continents
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
fit_continents <- land_continents %>%
model(
continents = ETS(LandAvgTemp)
)
report(fit_continents)
#land_continents %>% autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
fit_continents <- land_continents %>%
model(
continents = ETS(LandAvgTemp)
)
report(fit_continents)
accuracy(fit_continents)
#land_continents %>% autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
fit_continents <- land_continents %>%
model(
continents = ETS(LandAvgTemp)
)
fit_continents %>% filter(Country == "North America")
report(fit_continents)
#land_continents %>% autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
fit_continents <- land_continents %>%
model(
continents = ETS(LandAvgTemp)
)
report(fit_continents)
fit_continents %>% filter(Country == "North America") %>% report()
#land_continents %>% autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
fit_continents <- land_continents %>%
model(
continents = ETS(LandAvgTemp)
)
report(fit_continents)
fit_continents %>% filter(Country == "Africa") %>% report()
#land_continents %>% autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
land_continents <-
GlobalCountryTemp %>%
filter(Country %in% c("North America", "South America", "Europe", "Asia", "Oceania", "Africa")) %>%
filter(year(Date)>=1990)
fit_continents <- land_continents %>%
model(
continents = ETS(LandAvgTemp)
)
report(fit_continents)
fit_continents %>% filter(Country == "Oceania") %>% report()
#land_continents %>% autoplot(LandAvgTemp) + facet_grid(Country~., scales = "free_y")
fit_global_ocean <- global_temp %>%
model(
ANA_LandOcean = ETS(LandOceanAvgTemp),
AAA_LandOcean = ETS(LandOceanAvgTemp ~ error("A")+trend("A")+season("A")),
MAM_LandOcean = ETS(LandOceanAvgTemp ~ error("M")+trend("A")+season("M"))
)
report(fit_global_ocean)
fit_global_ocean %>% components() %>%  autoplot()
